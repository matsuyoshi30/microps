#+TITLE: memo

* プロトコル管理

- ネットワークデバイスはインターネット（ネットワーク）層のデータ（IP/IPv6/ARPなど）が運ばれる
  - どのプロトコルのデータかはリンクプロトコルからわかる
  - Ethernet であればヘッダに16ビットのタイプ番号がある
    - https://www.iana.org/assignments/ieee-802-numbers/ieee-802-numbers.xhtml#ieee-802-numbers-1
- プロトコルごとに受信キューでデータの受け取りを管理
- デバイスドライバがデータを受信して割り込みが発生して割り込みハンドラにデータが渡される
  - 割り込みハンドラがプロトコルに応じて適切な関数に渡す
    - プロトコル番号をもとにプロトコルを特定
    - プロトコルの受信キューにデータをエンキュー
    - 関数を呼び出す（これは次）

受信したデータをエントリにしてプロトコルごとにキューに詰めるところは mutex 取らなくても大丈夫？ここ net_input_handler は非同期じゃないのかな

* ソフトウェア割り込み

- 前段で受信キューにエンキューしたデータを処理するためには、処理用の関数を起動する必要がある
- キューにエンキューされたらソフトウェア割り込みを発生させて非同期に処理を行う

テストプログラムコピーしてるけど編集しない場合は同じだな（それはそう）
